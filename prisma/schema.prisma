generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = "file:./dev.db"
}

model User {
  id          String      @id @unique
  name        String
  telephone   String?
  email       String      @unique
  typeUser    Role
  manutences  Manutence[]
  messages    Chat[]

  historico HistoricoManutencao[]
}

enum Role {
  ADMIN
  USER
}

model Manutence {
  id                   String          @id @unique
  photos               Json
  video                String
  message              String          
  status_manutence     StatusManutence
  createdAt            DateTime
  userId               String
  user                 User            @relation(fields: [userId], references: [id])

  historico HistoricoManutencao[]
}

enum StatusManutence {
  FINALIZED
  IN_PROGRESS
  CANCELLED
  CREATED
}

model Chat {
  id              String   @id @unique
  message         String   
  sendAt          DateTime
  count_messages  Int
  userId          String
  user            User     @relation(fields: [userId], references: [id])
}

model NotificationsManutence {
  id                    String    @id @unique
  count_notifications   Int
  readAt                DateTime
  createdAt             DateTime
}

model HistoricoManutencao {
  id            String      @id @unique
  data          DateTime    @default(now())
  usuarioId     String
  typeUser      Role
  action        String
  manutenceId   String
  manutencao    Manutence  @relation(fields: [manutenceId], references: [id])
  usuario       User       @relation(fields: [usuarioId], references: [id])
}